\ProvidesPackage{fdutitle}[]
\RequirePackage{fdulogo}
\RequirePackage{xifthen}


\def\myid{}
\newcommand{\id}[1]{
    \def\myid{#1}
}

\def\mymajor{}
\newcommand{\major}[1]{
    \def\mymajor{#1}
}

\def\mycourse{}
\newcommand{\course}[1]{
    \def\mycourse{#1}
}

\def\mycourseid{}
\newcommand{\courseid}[1]{
  \def\mycourseid{#1}
}

\definecolor{titlepagecolor}{cmyk}{1,.60,0,.40}

\newcommand{\addtitledecoration}{
  \def\ifadddec{}
}

\newcommand{\settitlestyle}[1]{
  \def\mytitlestyle{#1}
}

\newcommand{\ifequals}[3]{\ifthenelse{\equal{#1}{#2}}{#3}{}}
\newcommand{\case}[2]{#1 #2} % Dummy, so \renewcommand has something to overwrite...
\newenvironment{switch}[1]{\renewcommand{\case}{\ifequals{#1}}}{}

\newcommand\titlepagedecoration{%
\begin{tikzpicture}[remember picture,overlay,shorten >= -10pt]

\coordinate (aux1) at ([yshift=-15pt]current page.north east);
\coordinate (aux2) at ([yshift=-410pt]current page.north east);
\coordinate (aux3) at ([xshift=-4.5cm]current page.north east);
\coordinate (aux4) at ([yshift=-150pt]current page.north east);
\coordinate (aux5) at ([yshift=+50pt]current page.south east);
\coordinate (aux6) at ([xshift=+40pt]current page.north west);
\coordinate (aux7) at ([yshift=+50pt]current page.south west);
\coordinate (aux8) at ([xshift=+60pt]current page.south west);
\coordinate (aux9) at ([yshift=+120pt]current page.south west);

\begin{scope}[titlepagecolor!40,line width=12pt,rounded corners=12pt]
\draw
  (aux1) -- coordinate (a)
  ++(225:5) --
  ++(-45:5.1) coordinate (b);
\draw[shorten <= -10pt]
  (aux3) --
  (a) --
  (aux1);
\draw[opacity=0.6,titlepagecolor,shorten <= -10pt]
  (b) --
  ++(225:2.2) --
  ++(-45:2.2);
\end{scope}
\draw[titlepagecolor,line width=8pt,rounded corners=8pt,shorten <= -10pt]
  (aux4) --
  ++(225:0.8) --
  ++(-45:0.8);
\begin{scope}[titlepagecolor!70,line width=6pt,rounded corners=8pt]
\draw[shorten <= -10pt]
  (aux2) --
  ++(225:3) coordinate[pos=0.45] (c) --
  ++(-45:3.1);
\draw
  (aux2) --
  (c) --
  ++(135:2.5) --
  ++(45:2.5) --
  ++(-45:2.5) coordinate[pos=0.3] (d);   
\draw 
  (d) -- +(45:1);
\end{scope}
\draw[titlepagecolor,line width=8pt,rounded corners=8pt,shorten <= -10pt]
  (aux5) --
  ++(135:1) --
  ++(225:2) --
  ++(-45:2);
\draw[opacity=0.6, titlepagecolor,line width=12pt,rounded corners=12pt,shorten <= -10pt]
  (aux6) --
  ++(-45:3) --
  ++(225:4) --
  ++(135:4);
\draw[opacity=0.4, titlepagecolor,line width=12pt,rounded corners=12pt,shorten <= -10pt]
  (aux6) --
  ++(-45:1.5) --
  ++(45:4);
\draw[opacity=0.8, titlepagecolor,line width=6pt,rounded corners=6pt,shorten <= -10pt]
  (aux7) --
  ++(45:3) --
  ++(-45:4) --
  ++(-135:4);
\draw[opacity=0.6, titlepagecolor,line width=6pt,rounded corners=6pt,shorten <= -10pt]
  (aux8) --
  ++(45:4) --
  ++(-45:5) --
  ++(-135:5);
\draw[opacity=0.6, titlepagecolor,line width=6pt,rounded corners=6pt,shorten <= -10pt]
  (aux9) --
  ++(45:1) --
  ++(135:1);
\end{tikzpicture}%
}


\newcommand{\makeclassic}{
  \newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
  \begin{titlepage}
  \begin{center}
  
  % Upper part of the page
  \quad \\[1.5cm]
  % \includegraphics[width=0.6\textwidth]{\currfiledir/res/fudan-name.pdf}
  \scalebox{0.35}{\fduname}
  \\[1.5cm]
  
  \textsc{\Huge \mycourse }\\[0.5cm]
  \textsc{\large \mycourseid}\\[1.5cm]
  
  % \includegraphics[width=0.22\textwidth]{\currfiledir/res/logo.pdf}
  \resizebox{0.22\textwidth}{0.22\textwidth}{\fduemblem+[color=FudanBlue]}
  \\[1.5cm]
  
  
  \vfill
  % Bottom of the page
  
  
  % \begin{tabular}{clc}
  %     \begin{minipage}[t]{0.1\textwidth}
  %         \large
  %             \centerline{论文题目}
  %             \centerline{专业}
  %             \centerline{姓名}
  %             \centerline{学号}
  %     \end{minipage} 
  %     &
  %     \begin{minipage}[t]{0.2\textwidth}
  %         \large
  %             \centerline{：}
  %             \centerline{：}
  %             \centerline{：}
  %             \centerline{：}
  %     \end{minipage} 
  %     &
  %     \begin{minipage}[t]{0.5\textwidth}
  %             \large
  %             \centerline{雅典民主与政策制定}
  %             \centerline{微电子科学与工程}
  %             \centerline{王渝}
  %             \centerline{15307130258}
  %     \end{minipage}
  % \end{tabular}\\[3cm]
  
  {\Large
  \begin{tabular}{cp{10cm}<{\centering}}
      设计课题：& \thetitle \\
      \cline{2-2}
      专\,\,\,\,\,\,\,\,\,\,\,\,业：& \mymajor \\
      \cline{2-2}
      姓\,\,\,\,\,\,\,\,\,\,\,\,名：& \theauthor \\
      \cline{2-2}
      学\,\,\,\,\,\,\,\,\,\,\,\,号：& \myid \\
      \cline{2-2}
  \end{tabular}\\[1.5cm]
  }
  
  {\large \thedate}
  
  \end{center}
  
  \ifx\ifadddec\undefined
  
  \else
  \titlepagedecoration
  \fi
  
  
  \end{titlepage}
}

\newcommand{\makesimple}{
  \begin{titlepage}

    \newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here
    
    \center % Center everything on the page
     
    %----------------------------------------------------------------------------------------
    %	HEADING SECTIONS
    %----------------------------------------------------------------------------------------
    
    % \textsc{\LARGE Uppsala University}\\[1.5cm] % Name of your university/college
    \scalebox{0.35}{\fduname}\\[1.5cm]
    % \includegraphics[scale=.1]{Uppsala_University_seal_svg.png}\\[1cm] % Include a department/university logo - this will require the graphicx package
    \resizebox{0.22\textwidth}{0.22\textwidth}{\fduemblem+[color=FudanBlue]}\\[1cm]
    \textsc{\Huge \mycourse}\\[0.5cm] % Major heading such as course name
    \textsc{\large \mycourseid}\\[0.5cm] % Minor heading such as course title
    
    %----------------------------------------------------------------------------------------
    %	TITLE SECTION
    %----------------------------------------------------------------------------------------
    
    \HRule \\[0.4cm]
    { \huge \bfseries \thetitle }\\ % Title of your document
    \HRule \\[1.5cm]
     
    %----------------------------------------------------------------------------------------
    %	AUTHOR SECTION
    %----------------------------------------------------------------------------------------
    
\begin{minipage}{0.4\textwidth}
  \begin{flushleft} \large
  作者：\\
  \theauthor % Your name
  \end{flushleft}
\end{minipage}
  ~
\begin{minipage}{0.4\textwidth}
  \begin{flushright} \large
  学号： \\
  \myid 
  \end{flushright}
\end{minipage}\\[2cm]
    
    % If you don't want a supervisor, uncomment the two lines below and remove the section above
    %\Large \emph{Author:}\\
    %John \textsc{Smith}\\[3cm] % Your name
    
    %----------------------------------------------------------------------------------------
    %	DATE SECTION
    %----------------------------------------------------------------------------------------
    
    {\large \thedate}\\[2cm] % Date, change the \today to a set date if you want to be precise
    
    \vfill % Fill the rest of the page with whitespace
    

    \ifx\ifadddec\undefined
  
    \else
    \titlepagedecoration
    \fi
    \end{titlepage}
}

\def\myclassic{classic}
\def\mysimple{simple}

\newcommand{\makefdutitle}{%
  \ifx\mytitlestyle\undefined
    \makeclassic
  \else
    \begin{switch}{\mytitlestyle}
      \case{classic}{\makeclassic}
      \case{simple}{\makesimple}
    \end{switch}
  \fi
}